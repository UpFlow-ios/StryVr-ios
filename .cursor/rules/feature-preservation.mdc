# Feature Preservation Rules for StryVr

## ðŸš¨ CRITICAL: Do Not Remove Working Features

### Core Features to Preserve
- **AIGreetingManager** - Personalized greetings system
- **Skill Dashboards** - Charts and analytics
- **Team Health Overview** - Employee insights
- **Behavior Feedback** - Workplace performance tracking
- **Learning Challenges** - Gamified progress system
- **Resume Builder** - Secure report generation
- **Enterprise Analytics** - Founder dashboard
- **Push Notifications** - User engagement system

## ðŸ”’ Protected Files

### AIGreetingManager.swift
```swift
// ðŸš¨ DO NOT MODIFY - Core to StryVr's identity
// Location: StryVr/Services/AIGreetingManager.swift
// Purpose: Powers personalized greetings and user experience
// Status: WORKING - Do not refactor or simplify
```

### Core Service Files
```swift
// ðŸš¨ PROTECTED - Essential business logic
// StryVr/Services/AIRecommendationService.swift
// StryVr/Services/AIProfileValidator.swift
// StryVr/Services/SkillService.swift
// StryVr/Services/NotificationService.swift
// StryVr/Services/PaymentService.swift
```

### Key View Files
```swift
// ðŸš¨ PROTECTED - Core user interfaces
// StryVr/Views/Home/HomeView.swift
// StryVr/Views/Insights/EmployeeInsightsDashboard.swift
// StryVr/Views/Challenges/ChallengeTrackerView.swift
// StryVr/Views/Profile/ProfileBadgesView.swift
```

## ðŸ›¡ï¸ Preservation Guidelines

### Before Making Changes
1. **Identify the feature** you're working with
2. **Check if it's working** - don't fix what isn't broken
3. **Understand the purpose** - why was it built this way?
4. **Test the impact** - will your change break other features?

### When Refactoring
```swift
// âœ… CORRECT - Preserve existing behavior
func existingWorkingFunction() {
    // Keep the original logic
    let result = performOriginalCalculation()
    
    // Add improvements without breaking existing functionality
    if let enhancedResult = enhanceResult(result) {
        return enhancedResult
    }
    
    // Fallback to original behavior
    return result
}

// âŒ WRONG - Replacing working logic
func existingWorkingFunction() {
    // Don't completely rewrite working functions
    return newImplementation() // This might break existing features
}
```

### Code Comments Strategy
```swift
// âœ… CORRECT - Comment out instead of delete
// TODO: Review this feature for potential improvements
// func oldFeature() {
//     // Original implementation
// }

// âœ… CORRECT - Mark for future review
// MARK: - Legacy Feature (Working - Do Not Remove)
func workingLegacyFeature() {
    // This feature works and is used by other parts of the app
    // Do not remove or simplify without thorough testing
}
```

## ðŸ” Feature Dependencies

### Interconnected Features
```swift
// ðŸš¨ DEPENDENCY CHAIN - These features work together
// 1. AIGreetingManager â†’ HomeView â†’ User Experience
// 2. SkillService â†’ SkillDashboards â†’ Analytics
// 3. NotificationService â†’ PushNotifications â†’ Engagement
// 4. PaymentService â†’ PaywallView â†’ Revenue
// 5. ChallengeService â†’ ChallengeTrackerView â†’ Gamification
```

### Data Flow Preservation
```swift
// ðŸš¨ PRESERVE - Data flow between services
class HomeViewModel: ObservableObject {
    // These dependencies must remain intact
    @Published var greeting: String = ""
    @Published var skills: [Skill] = []
    @Published var challenges: [Challenge] = []
    
    // Don't change these service calls
    func loadData() {
        greeting = aiGreetingManager.getGreeting()
        skills = skillService.getUserSkills()
        challenges = challengeService.getActiveChallenges()
    }
}
```

## ðŸŽ¯ Safe Modification Areas

### UI Improvements (Safe)
```swift
// âœ… SAFE - Visual enhancements
.background(.ultraThinMaterial) // Add glass effect
.animation(.easeInOut(duration: 0.3), value: isVisible) // Add animation
.shadow(color: .black.opacity(0.1), radius: 10, x: 0, y: 5) // Add depth
```

### Performance Optimizations (Safe)
```swift
// âœ… SAFE - Performance improvements
// Add caching
// Optimize image loading
// Reduce network calls
// Improve memory management
```

### Code Quality (Safe)
```swift
// âœ… SAFE - Code improvements
// Add proper error handling
// Improve type safety
// Add logging
// Fix Swift 6 compatibility
```

## ðŸš« Forbidden Actions

### Never Do These
- âŒ **Delete working functions** without thorough testing
- âŒ **Simplify complex logic** that serves a purpose
- âŒ **Remove error handling** that prevents crashes
- âŒ **Change data models** without migration strategy
- âŒ **Modify service interfaces** without updating all consumers
- âŒ **Remove UI components** that users interact with

### High-Risk Changes
```swift
// ðŸš¨ HIGH RISK - These changes require extensive testing
// 1. Modifying AIGreetingManager logic
// 2. Changing data model structures
// 3. Updating service method signatures
// 4. Removing authentication flows
// 5. Changing payment processing logic
```

## ðŸ”§ Safe Refactoring Patterns

### Extract Method (Safe)
```swift
// âœ… SAFE - Extract reusable logic
func complexCalculation() -> Double {
    let result = performCalculation()
    return formatResult(result)
}

// Extract into smaller functions
private func performCalculation() -> Double {
    // Original calculation logic
}

private func formatResult(_ value: Double) -> Double {
    // Format logic
}
```

### Add Features (Safe)
```swift
// âœ… SAFE - Add new functionality
extension ExistingService {
    func newFeature() {
        // New feature that doesn't break existing functionality
    }
}
```

### Improve Error Handling (Safe)
```swift
// âœ… SAFE - Better error handling
func existingFunction() {
    do {
        let result = try performOperation()
        handleSuccess(result)
    } catch {
        logger.error("Operation failed: \(error.localizedDescription)")
        handleError(error)
    }
}
```

## ðŸ“‹ Feature Inventory

### Core Features Status
- âœ… **AIGreetingManager** - Working, do not modify
- âœ… **Skill Dashboards** - Working, enhance carefully
- âœ… **Team Health** - Working, preserve functionality
- âœ… **Behavior Feedback** - Working, maintain data flow
- âœ… **Learning Challenges** - Working, keep gamification
- âœ… **Resume Builder** - Working, preserve security
- âœ… **Enterprise Analytics** - Working, maintain insights
- âœ… **Push Notifications** - Working, keep engagement

### Enhancement Priority
1. **Bug fixes** - Fix actual issues
2. **Performance** - Optimize without breaking
3. **UI polish** - Visual improvements
4. **New features** - Add without removing existing
5. **Code quality** - Improve maintainability

## ðŸŽ¯ Development Philosophy

### StryVr Development Principles
1. **Preserve working features** - If it works, don't break it
2. **Enhance carefully** - Add value without removing value
3. **Test thoroughly** - Every change affects user experience
4. **Document changes** - Future developers need to understand
5. **Respect the vision** - StryVr is building toward App Store success

### Success Metrics
- âœ… **No broken features** after changes
- âœ… **Improved performance** without regression
- âœ… **Better user experience** without disruption
- âœ… **Cleaner code** without functionality loss
- âœ… **App Store ready** - submission quality maintained
description:
globs:
alwaysApply: false
---
